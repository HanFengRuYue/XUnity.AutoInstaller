<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="XUnity_AutoInstaller.Pages.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XUnity_AutoInstaller.Pages"
    xmlns:viewmodels="using:XUnity_AutoInstaller.ViewModels"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Spacing="24" Margin="24">
            <!-- 页面标题 -->
            <TextBlock
                Text="欢迎使用 XUnity 自动安装器"
                Style="{StaticResource TitleTextBlockStyle}"/>

            <!-- 游戏路径选择区 -->
            <StackPanel Spacing="12">
                <TextBlock
                    Text="游戏路径"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Grid ColumnSpacing="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox
                        Grid.Column="0"
                        Text="{x:Bind ViewModel.GamePath, Mode=OneWay}"
                        PlaceholderText="请选择游戏根目录..."
                        IsReadOnly="True"/>

                    <Button
                        Grid.Column="1"
                        Style="{StaticResource AccentButtonStyle}"
                        Click="BrowseButton_Click">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B7;" FontSize="16"/>
                                <TextBlock Text="浏览选择"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Grid>
            </StackPanel>

            <!-- 状态卡片区 -->
            <Grid ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- BepInEx 状态卡片 -->
                <Border
                    Grid.Column="0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon
                                Glyph="&#xE7C3;"
                                FontSize="24"
                                Foreground="{ThemeResource SystemAccentColor}"/>
                            <TextBlock
                                Text="BepInEx"
                                Style="{StaticResource SubtitleTextBlockStyle}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="状态:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.BepInExStatus, Mode=OneWay}"
                                    Foreground="{x:Bind ViewModel.BepInExStatusColor, Mode=OneWay}"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="版本:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.BepInExVersion, Mode=OneWay}"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="目标平台:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.BepInExPlatform, Mode=OneWay}"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- XUnity 状态卡片 -->
                <Border
                    Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon
                                Glyph="&#xF2B7;"
                                FontSize="24"
                                Foreground="{ThemeResource SystemAccentColor}"/>
                            <TextBlock
                                Text="XUnity.AutoTranslator"
                                Style="{StaticResource SubtitleTextBlockStyle}"
                                VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="状态:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.XUnityStatus, Mode=OneWay}"
                                    Foreground="{x:Bind ViewModel.XUnityStatusColor, Mode=OneWay}"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="版本:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.XUnityVersion, Mode=OneWay}"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="翻译引擎:" FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="{x:Bind ViewModel.XUnityEngine, Mode=OneWay}"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- 快捷操作区 -->
            <StackPanel Spacing="12">
                <TextBlock
                    Text="快捷操作"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="12">
                    <!-- 一键安装按钮 -->
                    <Button
                        HorizontalAlignment="Stretch"
                        Style="{StaticResource AccentButtonStyle}"
                        Padding="16,12"
                        IsEnabled="{x:Bind ViewModel.IsQuickInstallButtonEnabled, Mode=OneWay}"
                        Click="QuickInstallButton_Click">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE896;" FontSize="20"/>
                            <StackPanel>
                                <TextBlock
                                    Text="一键安装"
                                    FontSize="16"
                                    FontWeight="SemiBold"/>
                                <TextBlock
                                    Text="自动安装 BepInEx 和 XUnity.AutoTranslator"
                                    FontSize="12"
                                    Opacity="0.8"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <!-- 其他快捷按钮 -->
                    <Grid ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Button
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            Click="OpenGameFolderButton_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B7;" FontSize="16"/>
                                <TextBlock Text="打开游戏文件夹"/>
                            </StackPanel>
                        </Button>

                        <Button
                            Grid.Column="1"
                            HorizontalAlignment="Stretch"
                            Click="RefreshStatusButton_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                                <TextBlock Text="刷新状态"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- 卸载按钮 -->
                    <Button
                        HorizontalAlignment="Stretch"
                        Padding="16,12"
                        IsEnabled="{x:Bind ViewModel.IsUninstallButtonEnabled, Mode=OneWay}"
                        Click="UninstallButton_Click">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <FontIcon Glyph="&#xE74D;" FontSize="20" Foreground="Red"/>
                                <StackPanel>
                                    <TextBlock
                                        Text="完全卸载"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Foreground="Red"/>
                                    <TextBlock
                                        Text="完全移除 BepInEx 和 XUnity.AutoTranslator"
                                        FontSize="12"
                                        Opacity="0.8"/>
                                </StackPanel>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </StackPanel>

            <!-- 进度显示区 -->
            <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.ProgressPanelVisibility, Mode=OneWay}">
                <TextBlock
                    Text="安装进度"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="12">
                        <ProgressBar
                            Maximum="100"
                            Value="{x:Bind ViewModel.InstallProgress, Mode=OneWay}"
                            Height="6"/>

                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing
                                IsActive="{x:Bind ViewModel.IsInstalling, Mode=OneWay}"
                                Width="20"
                                Height="20"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.InstallStatusMessage, Mode=OneWay}"
                                VerticalAlignment="Center"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.ProgressPercentText, Mode=OneWay}"
                                VerticalAlignment="Center"
                                Foreground="{ThemeResource SystemAccentColor}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 信息提示区 -->
            <InfoBar
                x:Name="StatusInfoBar"
                IsOpen="False"
                IsClosable="True"
                Severity="Informational"
                Title="提示"
                Message="这里会显示操作提示和状态信息"/>
        </StackPanel>
    </ScrollViewer>
</Page>
