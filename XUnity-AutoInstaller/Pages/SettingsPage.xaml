<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="XUnity_AutoInstaller.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XUnity_AutoInstaller.Pages"
    xmlns:viewmodels="using:XUnity_AutoInstaller.ViewModels"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Spacing="24" Margin="24">
            <!-- 页面标题 -->
            <TextBlock
                Text="设置"
                Style="{StaticResource TitleTextBlockStyle}"/>

            <!-- 外观 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="外观"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="应用主题" FontWeight="SemiBold"/>
                            <RadioButtons SelectedIndex="{x:Bind ViewModel.ThemeSelectedIndex, Mode=TwoWay}">
                                <RadioButton Content="跟随系统" Tag="Default"/>
                                <RadioButton Content="浅色模式" Tag="Light"/>
                                <RadioButton Content="深色模式" Tag="Dark"/>
                            </RadioButtons>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 常规 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="常规"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <CheckBox
                            Content="记住上次选择的游戏路径"
                            IsChecked="{x:Bind ViewModel.RememberLastGamePath, Mode=TwoWay}"/>
                        <CheckBox
                            Content="下载时显示详细进度"
                            IsChecked="{x:Bind ViewModel.ShowDetailedProgress, Mode=TwoWay}"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 默认安装选项 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="默认安装选项"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <CheckBox
                            Content="默认备份现有文件"
                            IsChecked="{x:Bind ViewModel.DefaultBackupExisting, Mode=TwoWay}"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 下载源设置 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="下载源设置"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="版本列表和下载来源" FontWeight="SemiBold"/>
                            <TextBlock
                                Text="镜像网站可提供更快的访问速度，在无法访问GitHub时会自动切换。"
                                Opacity="0.7"
                                TextWrapping="Wrap"/>
                        </StackPanel>

                        <RadioButtons SelectedIndex="{x:Bind ViewModel.DownloadSourceSelectedIndex, Mode=TwoWay}">
                            <RadioButton Tag="GitHub">
                                <RadioButton.Content>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="GitHub 官方仓库" FontWeight="SemiBold"/>
                                        <TextBlock Text="直接从GitHub下载（推荐）" Opacity="0.7" FontSize="12"/>
                                    </StackPanel>
                                </RadioButton.Content>
                            </RadioButton>
                            <RadioButton Tag="Mirror">
                                <RadioButton.Content>
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="镜像网站" FontWeight="SemiBold"/>
                                        <TextBlock Text="从WebDAV镜像站下载（国内用户推荐）" Opacity="0.7" FontSize="12"/>
                                    </StackPanel>
                                </RadioButton.Content>
                            </RadioButton>
                        </RadioButtons>

                        <StackPanel Spacing="8">
                            <TextBlock Text="连接状态" FontWeight="SemiBold"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.ConnectionStatus, Mode=OneWay}"
                                Opacity="0.7"/>
                        </StackPanel>

                        <Button Click="TestConnectionButton_Click">
                            <Button.Content>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE895;" FontSize="14"/>
                                    <TextBlock Text="测试连接"/>
                                </StackPanel>
                            </Button.Content>
                        </Button>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 下载缓存管理 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="下载缓存管理"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="缓存大小" FontWeight="SemiBold"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.CacheSize, Mode=OneWay}"
                                Opacity="0.7"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <TextBlock Text="缓存位置" FontWeight="SemiBold"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.CachePath, Mode=OneWay}"
                                Opacity="0.7"
                                TextWrapping="Wrap"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <Button Click="OpenCacheFolderButton_Click">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8B7;" FontSize="14"/>
                                        <TextBlock Text="打开缓存文件夹"/>
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                            <Button Click="CleanCacheButton_Click">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                        <TextBlock Text="清理缓存"/>
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 数据管理 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="数据管理"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="配置文件位置" FontWeight="SemiBold"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.SettingsPath, Mode=OneWay}"
                                Opacity="0.7"
                                TextWrapping="Wrap"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <Button Click="OpenSettingsFolderButton_Click">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8B7;" FontSize="14"/>
                                        <TextBlock Text="打开配置文件夹"/>
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                            <Button Click="ResetAllDataButton_Click">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE7A7;" FontSize="14"/>
                                        <TextBlock Text="重置所有数据"/>
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- 关于 -->
            <StackPanel Spacing="16">
                <TextBlock
                    Text="关于"
                    Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20">
                    <StackPanel Spacing="16">
                        <StackPanel Spacing="8">
                            <TextBlock Text="XUnity 自动安装器" FontWeight="SemiBold" FontSize="16"/>
                            <TextBlock
                                Text="{x:Bind ViewModel.AppVersion, Mode=OneWay}"
                                Opacity="0.7"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <TextBlock Text="BepInEx 和 XUnity.AutoTranslator 自动安装器" TextWrapping="Wrap"/>
                            <TextBlock Text="为 Unity 游戏提供一键安装翻译插件功能" TextWrapping="Wrap" Opacity="0.7" FontSize="12"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <HyperlinkButton
                                Content="访问 GitHub 仓库"
                                NavigateUri="https://github.com/HanFengRuYue/XUnity.AutoInstaller"/>
                            <HyperlinkButton
                                Content="BepInEx 官方文档"
                                NavigateUri="https://docs.bepinex.dev/"/>
                            <HyperlinkButton
                                Content="XUnity.AutoTranslator GitHub"
                                NavigateUri="https://github.com/bbepis/XUnity.AutoTranslator"/>
                        </StackPanel>

                        <StackPanel Spacing="8">
                            <TextBlock Text="开源协议" FontWeight="SemiBold"/>
                            <TextBlock Text="MIT License" Opacity="0.7" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</Page>
