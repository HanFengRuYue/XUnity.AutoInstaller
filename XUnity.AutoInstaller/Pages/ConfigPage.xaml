<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="XUnity.AutoInstaller.Pages.ConfigPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XUnity.AutoInstaller.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 配置内容区 -->
        <ScrollViewer Grid.Row="0" x:Name="ConfigScrollViewer">
            <StackPanel Spacing="24" Margin="24">
                <!-- 页面标题 -->
                <TextBlock
                    Text="配置编辑"
                    Style="{StaticResource TitleTextBlockStyle}"/>

                <!-- 错误提示 -->
                <InfoBar
                    x:Name="ErrorInfoBar"
                    Severity="Error"
                    IsOpen="False"
                    IsClosable="True"
                    Title="错误"/>

                <!-- 加载指示器 -->
                <StackPanel
                    x:Name="LoadingPanel"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center"
                    Spacing="16"
                    Margin="40">
                    <ProgressRing IsActive="True" Width="60" Height="60"/>
                    <TextBlock
                        Text="正在加载配置文件..."
                        Style="{StaticResource SubtitleTextBlockStyle}"
                        HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- 配置内容面板 -->
                <StackPanel x:Name="ConfigContentPanel" Spacing="16">
                    <!-- 游戏路径提示 -->
                    <InfoBar
                        x:Name="GamePathInfoBar"
                        Severity="Informational"
                        IsOpen="True"
                        IsClosable="False"
                        Title="提示"
                        Message="如果未检测到游戏路径或BepInEx未安装，请点击下方按钮选择游戏目录">
                        <InfoBar.ActionButton>
                            <Button
                                Content="选择游戏目录"
                                Click="BrowseGamePathButton_Click"/>
                        </InfoBar.ActionButton>
                    </InfoBar>

                <!-- BepInEx 配置组 -->
                <StackPanel Spacing="16">
                    <TextBlock
                        Text="BepInEx 配置"
                        Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <!-- Logging 日志配置 -->
                    <Expander
                        Header="Logging 日志配置"
                        IsExpanded="True"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="启用控制台 (Console)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="ConsoleToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="False"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="控制台 Shift-JIS 支持 (Console ShiftJIS)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="启用后支持日语字符显示（禁用时使用 UTF-8）"
                                        FontSize="12"
                                        Opacity="0.7"/>
                                    <ToggleSwitch
                                        x:Name="ConsoleShiftJISToggle"
                                        OnContent="Shift-JIS"
                                        OffContent="UTF-8"
                                        IsOn="False"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="预加载器详细日志 (Preloader LogConsole)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="启用后每次启动都创建详细的预加载器日志"
                                        FontSize="12"
                                        Opacity="0.7"/>
                                    <ToggleSwitch
                                        x:Name="PreloaderLogConsoleToggle"
                                        OnContent="详细日志"
                                        OffContent="仅错误时"
                                        IsOn="False"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="日志显示级别 (Logger Displayed Levels)" FontWeight="SemiBold"/>
                                    <ComboBox
                                        x:Name="LoggerDisplayedLevelsComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="5">
                                        <ComboBoxItem Content="None - 无日志"/>
                                        <ComboBoxItem Content="Fatal - 仅致命错误"/>
                                        <ComboBoxItem Content="Error - 错误及以上"/>
                                        <ComboBoxItem Content="Warning - 警告及以上"/>
                                        <ComboBoxItem Content="Message - 消息及以上"/>
                                        <ComboBoxItem Content="Info - 信息及以上（推荐）"/>
                                        <ComboBoxItem Content="Debug - 调试及以上"/>
                                        <ComboBoxItem Content="All - 全部日志"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="显示 Unity 日志消息 (Chainloader Log Unity Messages)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="ChainloaderLogUnityMessagesToggle"
                                        OnContent="显示"
                                        OffContent="隐藏"
                                        IsOn="False"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Preloader 预加载器配置 (高级)-->
                    <Expander
                        Header="Preloader 预加载器配置（高级）"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <TextBlock
                                    Text="⚠️ 警告：这些是高级开发者选项，修改不当可能导致游戏无法启动"
                                    Foreground="{ThemeResource SystemFillColorCautionBrush}"
                                    FontSize="12"
                                    TextWrapping="Wrap"/>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="入口点程序集 (Entrypoint Assembly)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="EntrypointAssemblyTextBox"
                                        PlaceholderText="UnityEngine.dll"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="入口点类型 (Entrypoint Type)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="EntrypointTypeTextBox"
                                        PlaceholderText="Application"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="入口点方法 (Entrypoint Method)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="EntrypointMethodTextBox"
                                        PlaceholderText=".cctor"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="转储程序集 (Dump Assemblies)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="启用后会将修补后的程序集保存到 BepInEx/DumpedAssemblies 用于调试"
                                        FontSize="12"
                                        Opacity="0.7"
                                        TextWrapping="Wrap"/>
                                    <ToggleSwitch
                                        x:Name="DumpAssembliesToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="False"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>

                <!-- XUnity.AutoTranslator 配置组 -->
                <StackPanel Spacing="16">
                    <TextBlock
                        Text="XUnity.AutoTranslator 配置"
                        Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <!-- Service 服务配置 -->
                    <Expander
                        Header="Service 服务配置"
                        IsExpanded="True"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="翻译服务 (Endpoint)" FontWeight="SemiBold"/>
                                    <ComboBox
                                        x:Name="EndpointComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="0">
                                        <ComboBoxItem Content="GoogleTranslate（谷歌翻译-免费）"/>
                                        <ComboBoxItem Content="BingTranslate（必应翻译-免费）"/>
                                        <ComboBoxItem Content="DeepL（DeepL-免费）"/>
                                        <ComboBoxItem Content="Papago（Papago-免费）"/>
                                        <ComboBoxItem Content="BaiduTranslate（百度翻译-免费）"/>
                                        <ComboBoxItem Content="YandexTranslate（Yandex-免费）"/>
                                        <ComboBoxItem Content="WatsonTranslate（Watson-需认证）"/>
                                        <ComboBoxItem Content="GoogleCloudTranslate（谷歌云-需认证）"/>
                                        <ComboBoxItem Content="AzureTranslate（Azure-需认证）"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="备用翻译服务 (Fallback Endpoint)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="当主要服务失败时使用的备用服务"
                                        FontSize="12"
                                        Opacity="0.7"/>
                                    <ComboBox
                                        x:Name="FallbackEndpointComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="0">
                                        <ComboBoxItem Content="无"/>
                                        <ComboBoxItem Content="BingTranslate"/>
                                        <ComboBoxItem Content="GoogleTranslate"/>
                                        <ComboBoxItem Content="DeepL"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- General 基本配置 -->
                    <Expander
                        Header="General 基本配置"
                        IsExpanded="True"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="目标语言 (Language)" FontWeight="SemiBold"/>
                                    <ComboBox
                                        x:Name="LanguageComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="0">
                                        <ComboBoxItem Content="zh-CN（简体中文）"/>
                                        <ComboBoxItem Content="zh-TW（繁体中文）"/>
                                        <ComboBoxItem Content="en（英语）"/>
                                        <ComboBoxItem Content="ja（日语）"/>
                                        <ComboBoxItem Content="ko（韩语）"/>
                                        <ComboBoxItem Content="fr（法语）"/>
                                        <ComboBoxItem Content="de（德语）"/>
                                        <ComboBoxItem Content="es（西班牙语）"/>
                                        <ComboBoxItem Content="ru（俄语）"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="源语言 (From Language)" FontWeight="SemiBold"/>
                                    <ComboBox
                                        x:Name="FromLanguageComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="1">
                                        <ComboBoxItem Content="auto（自动检测）"/>
                                        <ComboBoxItem Content="ja（日语）"/>
                                        <ComboBoxItem Content="en（英语）"/>
                                        <ComboBoxItem Content="ko（韩语）"/>
                                        <ComboBoxItem Content="zh-CN（简体中文）"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="最大翻译字符数 (Max Characters Per Translation)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="单次翻译的最大字符数（20-2500）"
                                        FontSize="12"
                                        Opacity="0.7"/>
                                    <NumberBox
                                        x:Name="MaxCharactersPerTranslationNumber"
                                        Minimum="20"
                                        Maximum="2500"
                                        SpinButtonPlacementMode="Inline"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="最小对话字符 (Min Dialogue Chars)" FontWeight="SemiBold"/>
                                    <NumberBox
                                        x:Name="MinDialogueCharsNumber"
                                        Value="20"
                                        Minimum="1"
                                        Maximum="100"
                                        SpinButtonPlacementMode="Inline"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="忽略对话空白 (Ignore Whitespace In Dialogue)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="IgnoreWhitespaceInDialogueToggle"
                                        OnContent="忽略"
                                        OffContent="保留"
                                        IsOn="True"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="启用 UI 自动调整 (Enable UI Resizing)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="自动调整 UI 组件大小以适应翻译后的文本"
                                        FontSize="12"
                                        Opacity="0.7"
                                        TextWrapping="Wrap"/>
                                    <ToggleSwitch
                                        x:Name="EnableUIResizingToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="True"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="覆盖字体 (Override Font)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="OverrideFontTextBox"
                                        PlaceholderText="例如: Microsoft YaHei"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="复制到剪贴板 (Copy To Clipboard)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="CopyToClipboardToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="False"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Text Frameworks 文本框架配置 -->
                    <Expander
                        Header="Text Frameworks 文本框架配置"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <TextBlock
                                    Text="选择要Hook的Unity文本框架"
                                    FontSize="12"
                                    Opacity="0.7"
                                    TextWrapping="Wrap"/>

                                <ToggleSwitch
                                    x:Name="EnableUGUIToggle"
                                    Header="UGUI"
                                    OnContent="已启用"
                                    OffContent="已禁用"
                                    IsOn="True"/>

                                <ToggleSwitch
                                    x:Name="EnableNGUIToggle"
                                    Header="NGUI"
                                    OnContent="已启用"
                                    OffContent="已禁用"
                                    IsOn="True"/>

                                <ToggleSwitch
                                    x:Name="EnableTextMeshProToggle"
                                    Header="TextMeshPro"
                                    OnContent="已启用"
                                    OffContent="已禁用"
                                    IsOn="True"/>

                                <ToggleSwitch
                                    x:Name="EnableTextMeshToggle"
                                    Header="TextMesh"
                                    OnContent="已启用"
                                    OffContent="已禁用"
                                    IsOn="False"/>

                                <ToggleSwitch
                                    x:Name="EnableIMGUIToggle"
                                    Header="IMGUI"
                                    OnContent="已启用"
                                    OffContent="已禁用"
                                    IsOn="False"/>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Files 文件配置 -->
                    <Expander
                        Header="Files 文件配置"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="缓存目录 (Directory)" FontWeight="SemiBold"/>
                                    <Grid ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox
                                            x:Name="DirectoryTextBox"
                                            Grid.Column="0"
                                            PlaceholderText="Translation"
                                            HorizontalAlignment="Stretch"/>
                                        <Button
                                            Grid.Column="1"
                                            Content="浏览"
                                            Click="BrowseDirectoryButton_Click"/>
                                    </Grid>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="输出文件 (Output File)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="OutputFileTextBox"
                                        PlaceholderText="_AutoGeneratedTranslations.txt"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="替换文件 (Substitution File)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="SubstitutionFileTextBox"
                                        PlaceholderText="_Substitutions.txt"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="预处理器文件 (Preprocessors File)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="PreprocessorsFileTextBox"
                                        PlaceholderText="_Preprocessors.txt"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="后处理器文件 (Postprocessors File)" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="PostprocessorsFileTextBox"
                                        PlaceholderText="_Postprocessors.txt"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Texture 纹理翻译配置 -->
                    <Expander
                        Header="Texture 纹理翻译配置"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="纹理目录 (Texture Directory)" FontWeight="SemiBold"/>
                                    <Grid ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox
                                            x:Name="TextureDirectoryTextBox"
                                            Grid.Column="0"
                                            PlaceholderText="AutoTranslator/Texture"
                                            HorizontalAlignment="Stretch"/>
                                        <Button
                                            Grid.Column="1"
                                            Content="浏览"
                                            Click="BrowseTextureDirectoryButton_Click"/>
                                    </Grid>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="启用纹理翻译 (Enable Texture Translation)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="EnableTextureTranslationToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="True"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="启用纹理转储 (Enable Texture Dumping)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="将游戏纹理导出以便进行翻译编辑"
                                        FontSize="12"
                                        Opacity="0.7"
                                        TextWrapping="Wrap"/>
                                    <ToggleSwitch
                                        x:Name="EnableTextureDumpingToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="False"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="纹理哈希生成策略 (Texture Hash Generation Strategy)" FontWeight="SemiBold"/>
                                    <ComboBox
                                        x:Name="TextureHashGenerationStrategyComboBox"
                                        HorizontalAlignment="Stretch"
                                        SelectedIndex="0">
                                        <ComboBoxItem Content="FromImageName"/>
                                        <ComboBoxItem Content="FromImageData"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Advanced 高级配置 -->
                    <Expander
                        Header="Advanced 高级配置"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="启用翻译作用域 (Enable Translation Scoping)" FontWeight="SemiBold"/>
                                    <TextBlock
                                        Text="支持TARC指令解析"
                                        FontSize="12"
                                        Opacity="0.7"/>
                                    <ToggleSwitch
                                        x:Name="EnableTranslationScopingToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="True"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="处理富文本 (Handle Rich Text)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="HandleRichTextToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="True"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="文本解析器最大递归深度 (Max Text Parser Recursion)" FontWeight="SemiBold"/>
                                    <NumberBox
                                        x:Name="MaxTextParserRecursionNumber"
                                        Value="10"
                                        Minimum="1"
                                        Maximum="100"
                                        SpinButtonPlacementMode="Inline"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="HTML 实体预处理 (Html Entity Preprocessing)" FontWeight="SemiBold"/>
                                    <ToggleSwitch
                                        x:Name="HtmlEntityPreprocessingToggle"
                                        OnContent="已启用"
                                        OffContent="已禁用"
                                        IsOn="True"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>

                    <!-- Authentication 认证配置（可选） -->
                    <Expander
                        Header="Authentication 认证配置（可选）"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch">
                        <Border
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="0,0,8,8"
                            Padding="20"
                            HorizontalAlignment="Stretch">
                            <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                                <TextBlock
                                    Text="需要认证的翻译服务配置（仅在使用相应服务时填写）"
                                    FontSize="12"
                                    Opacity="0.7"
                                    TextWrapping="Wrap"/>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Google API Key" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="GoogleAPIKeyTextBox"
                                        PlaceholderText="输入Google Cloud Translation API密钥"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Bing Subscription Key" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="BingSubscriptionKeyTextBox"
                                        PlaceholderText="输入Azure Translator订阅密钥"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="DeepL API Key" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="DeepLAPIKeyTextBox"
                                        PlaceholderText="输入DeepL API密钥"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Baidu AppId" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="BaiduAppIdTextBox"
                                        PlaceholderText="输入百度翻译AppId"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Baidu AppSecret" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="BaiduAppSecretTextBox"
                                        PlaceholderText="输入百度翻译AppSecret"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Yandex API Key" FontWeight="SemiBold"/>
                                    <TextBox
                                        x:Name="YandexAPIKeyTextBox"
                                        PlaceholderText="输入Yandex翻译API密钥"
                                        HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Expander>
                </StackPanel>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- 底部操作栏 -->
        <Border
            Grid.Row="1"
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="0,1,0,0"
            Padding="24,16">
            <Grid ColumnSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button
                    Grid.Column="0"
                    HorizontalAlignment="Left"
                    Click="OpenConfigFolderButton_Click">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xE8B7;" FontSize="16"/>
                        <TextBlock Text="打开配置文件夹"/>
                    </StackPanel>
                </Button>

                <Button
                    Grid.Column="1"
                    Content="重置为默认"
                    Click="ResetButton_Click"/>

                <Button
                    Grid.Column="2"
                    Content="取消"
                    Click="CancelButton_Click"/>

                <Button
                    Grid.Column="3"
                    Style="{StaticResource AccentButtonStyle}"
                    Click="SaveButton_Click">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74E;" FontSize="16"/>
                            <TextBlock Text="保存配置"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Page>
